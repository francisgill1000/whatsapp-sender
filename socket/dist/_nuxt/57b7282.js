(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{868:function(t,e,n){"use strict";n.r(e);var r=n(863),o=n(768),c=n(729),l=n(731),d=n(203),h=n(759),v=n(13),m=n(2);n(5),n(75),n(91),n(30),n(62);function w(){var t="device_id",e=localStorage.getItem(t);return e||(e=Math.random().toString(36).substr(2,9)+Date.now().toString(36),localStorage.setItem(t,e)),e}var _=n(367),C=n.n(_);function f(t){return I.apply(this,arguments)}function I(){return(I=Object(v.a)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,C.a.toDataURL(e,{errorCorrectionLevel:"H"});case 3:return n=t.sent,t.abrupt("return",n);case 7:throw t.prev=7,t.t0=t.catch(0),new Error("Error generating QR code: "+t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))).apply(this,arguments)}var x={auth:!1,layout:"guest",data:function(){var t;return t={loading:!1,ws:null,clientId:"",serverUrl:"wss://node.wabridge.online/ws/",endpoint:"https://node.wabridge.online/api/send-message",qrCodeUrl:"",statusMessage:"",statusColor:""},Object(m.a)(t,"loading",!1),Object(m.a)(t,"isConnected",!1),Object(m.a)(t,"qrImage",null),t},mounted:function(){var t=this;return Object(v.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.connectToWebSocket(),n=w(),e.next=4,f(n);case 4:t.qrImage=e.sent,console.log("ðŸš€ ~ mounted ~ this.qrImage:",t.qrImage);case 6:case"end":return e.stop()}}),e)})))()},methods:{disconnect:function(){this.ws&&this.ws.readyState===WebSocket.OPEN?(this.ws.send(JSON.stringify({type:"disconnect",clientId:localStorage.getItem("clientId")})),this.statusMessage="Disconnected from WhatsApp.",this.statusColor="warning",this.qrCodeUrl="",localStorage.removeItem("clientId"),console.log("WhatsApp client disconnected.")):(console.warn("WebSocket is not open or already disconnected."),this.statusMessage="No active connection to disconnect from WhatsApp.",this.statusColor="error")},connectToWebSocket:function(){var t=this;this.clientId="";var e=localStorage.getItem("clientId");e||(e="client_".concat(Math.random().toString(36).substr(2,9)),localStorage.setItem("clientId",e)),this.clientId=e,this.serverUrl.trim()?(this.ws=new WebSocket("".concat(this.serverUrl,"?clientId=").concat(e)),this.loading=!0,this.ws.onopen=function(){console.log("WebSocket connection established."),t.ws.send(JSON.stringify({type:"clientId",clientId:e}))},this.ws.onmessage=function(n){var data=JSON.parse(n.data);"qr"===data.type||"clientId"===data.type?(t.qrCodeUrl="https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=".concat(encodeURIComponent(data.qr)),t.statusMessage="Scan the QR code to connect.",t.loading=!1,t.statusColor="red"):"status"===data.type&&data.ready?(console.log("ðŸš€ ~ connectToWebSocket ~ data:",data),t.statusMessage=data.message,t.statusColor="success",t.qrCodeUrl="",t.loading=!1,t.isConnected=!1,t.clientId=e):"error"===data.type&&(t.statusMessage="Error: ".concat(data.message),t.statusColor="error",t.qrCodeUrl="",t.loading=!1)}):alert("Please enter a valid WebSocket server URL.")},reloadPage:function(){location.reload()}}},S=n(74),component=Object(S.a)(x,(function(){var t=this,e=t._self._c;return e(l.a,[e(h.a,{staticClass:"mb-3"},[e(c.a,{attrs:{cols:"12"}},[e("h1",[t._v("Whatsapp Bridge")])]),t._v(" "),e(c.a,{attrs:{cols:"12"}},[t.loading?e("p",{staticClass:"mt-3",attrs:{dense:"",flat:""}},[t._v("Waiting for connection...")]):t._e(),t._v(" "),t.qrCodeUrl?e(h.a,{},[e(c.a,[e(d.a,{attrs:{src:t.qrCodeUrl,"max-width":"300"}})],1)],1):t._e(),t._v(" "),t.statusMessage?e(h.a,{},[e(c.a,{attrs:{cols:"4"}},[e("div",{staticClass:"white ma-2",attrs:{dense:""}},[e(r.a,{staticClass:"mr-5",attrs:{"x-small":"",dense:"","hide-details":"",color:t.statusColor}}),t._v(" "),e("span",[t._v(t._s(t.statusMessage))])],1)])],1):t._e(),t._v(" "),e(h.a,[e(c.a,[e(o.a,[e(l.a,{staticClass:"pa-5"},[e("h3",{staticClass:"white"},[t._v("API Usage Example")]),t._v(" "),e("p",{staticClass:"black white--text pa-2 my-3"},[e("strong",[t._v("Endpoint:")]),t._v(" "),e("code",[t._v(" "+t._s(t.endpoint))])]),t._v(" "),e("div",{staticClass:"black white--text pa-2"},[t._v("Request")]),t._v(" "),e("pre",{staticClass:"black white--text pa-2 mb-3"},[t._v('{\n  "clientId": "'+t._s(t.clientId)+'",\n  "phone": "971xxxxxxxxx",\n  "message": "test message"\n}\n')]),t._v(" "),e("div",{staticClass:"black white--text pa-2"},[t._v("Request")]),t._v(" "),e("pre",{staticClass:"black white--text pa-2 mb-3"},[t._v('{\n  "success": true,\n  "message": "Message sent successfully!"\n}\n')])])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports}}]);